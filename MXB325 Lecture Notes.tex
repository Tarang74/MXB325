%!TEX TS-program = xelatex
%!TEX options = -aux-directory=Debug -shell-escape -file-line-error -interaction=nonstopmode -halt-on-error -synctex=1 "%DOC%"
\documentclass{article}
\input{LaTeX-Submodule/template.tex}

% Additional packages & macros
\usepackage{mdframed}
\theoremstyle{definition}
\newtheorem{example}{Example}[section]
\DeclareMathOperator{\Log}{Log}

% Header and footer
\newcommand{\unitName}{Differential Equations and Modelling 2}
\newcommand{\unitTime}{Semester 2, 2024}
\newcommand{\unitCoordinator}{Professor Scott McCue}
\newcommand{\documentAuthors}{Tarang Janawalkar}

\fancyhead[L]{\unitName}
\fancyhead[R]{\leftmark}
\fancyfoot[C]{\thepage}

% Copyright
\usepackage[
  type={CC},
  modifier={by-nc-sa},
  version={4.0},
  imagewidth={5em},
  hyphenation={raggedright}
]{doclicense}

\newenvironment{aside}[1][]
  {\begin{mdframed}[style=0,%
      leftline=false,rightline=false,leftmargin=2em,rightmargin=2em,%
          innerleftmargin=0pt,innerrightmargin=0pt,linewidth=0.75pt,%
      skipabove=7pt,skipbelow=7pt,#1]\small}
  {\end{mdframed}}

\date{}

\begin{document}
%
\begin{titlepage}
    \vspace*{\fill}
    \begin{center}
        \LARGE{\textbf{\unitName}} \\[0.1in]
        \normalsize{\unitTime} \\[0.2in]
        \normalsize\textit{\unitCoordinator} \\[0.2in]
        \documentAuthors
    \end{center}
    \vspace*{\fill}
    \doclicenseThis
    \thispagestyle{empty}
\end{titlepage}
\newpage
%
\tableofcontents
\newpage
%
\part{Symmetry Methods}
\section{Symmetry Transformations}
Consider a partial differential equation for \(u\left( x,\: t \right)\)
whose domain lies in \(\R^2\). Such a problem typically does not have
any natural length or time scales associated with it's fundamental
solution. Thus, let us transform the independent and dependent
variables through the mapping \(\left( x,\: t,\: u \right) \mapsto
\left( X,\: T,\: U \right)\) where \(X = X\left( x,\: t,\: u \right)\),
\(T = T\left( x,\: t,\: u \right)\), and \(U = U\left( x,\: t,\: u
\right)\), such that the PDE is invariant under this transformation,
that is, the transformed PDE in \(U\) has the same form as the original
PDE in \(u\).

The choice of mapping may consist of dilations and translations of the
independent and dependent variables by some constant factors, where
each constant is enforced by the invariance condition. To do this, we
must ensure that the function \(U\left( x,\: t,\: u\left( X,\: T
\right) \right)\) satisfies the transformed PDE. When this is the case,
the PDE is said to have a \textit{symmetry transformation}.

The goal of these symmetry methods is to find an appropriate
transformation that simplifies the PDE, often reducing it to an ODE.
\subsection{Dilation Symmetry}
A dilation symmetry is a transformation of the form
\begin{equation*}
    X = a x, \quad T = a^\beta t, \quad U = a^\gamma u,
\end{equation*}
where \(a\), \(\beta\), and \(\gamma\) are constants. Note that we do
not express the transformation for \(x\) as \(X = a^\alpha x\) since it
does not provide any additional information.
\begin{example}
    Consider the transport equation
    \begin{equation*}
        \pdv{u\left( x,\: t \right)}{t} + c \pdv{u\left( x,\: t \right)}{x} = 0
    \end{equation*}
    and the mapping
    \begin{equation*}
        X = a x, \quad T = a^\beta t, \quad U = u.
    \end{equation*}
    After substituting the transformed solution into the PDE, we find
    \begin{align*}
        \pdv{u\left( X,\: T \right)}{t} + c \pdv{u\left( X,\: T \right)}{x}                       & = 0  \\
        \pdv{u\left( X,\: T \right)}{T} \odv{T}{t} + c \pdv{u\left( X,\: T \right)}{X} \odv{X}{x} & = 0  \\
        a^\beta \pdv{u\left( X,\: T \right)}{T} + a c \pdv{u\left( X,\: T \right)}{X}             & = 0.
    \end{align*}
    For this PDE to be invariant under a dilation transformation, we
    must factor out the constant \(a\) from the equation. This implies
    that:
    \begin{equation*}
        a^\beta = a \implies \beta = 1,
    \end{equation*}
    so that
    \begin{equation*}
        \pdv{u\left( X,\: T \right)}{T} + c \pdv{u\left( X,\: T \right)}{X} = 0.
    \end{equation*}
    Here we have shown that the transport equation is invariant under
    the above dilation transformation when \(\beta = 1\).
\end{example}
\begin{example}
    Consider the nonlinear PDE
    \begin{equation*}
        \pdv{u\left( x,\: y \right)}{x} + y^2 \pdv{u\left( x,\: y \right)}{y} = 0
    \end{equation*}
    and the mapping
    \begin{equation*}
        X = a x, \quad Y = a^\beta y, \quad U = u.
    \end{equation*}
    By substituting the transformed solution into the PDE, we find
    \begin{align*}
        \pdv{u\left( X,\: Y \right)}{x} + y^2 \pdv{u\left( X,\: Y \right)}{y}                                    & = 0  \\
        \pdv{u\left( X,\: Y \right)}{X} \odv{X}{x} + y^2 \pdv{u\left( X,\: Y \right)}{Y} \odv{Y}{y}              & = 0  \\
        a \pdv{u\left( X,\: Y \right)}{X} + a^\beta y^2 \pdv{u\left( X,\: Y \right)}{Y}                          & = 0  \\
        a \pdv{u\left( X,\: Y \right)}{X} + a^\beta \left( Y / a^\beta \right)^2 \pdv{u\left( X,\: Y \right)}{Y} & = 0  \\
        a \pdv{u\left( X,\: Y \right)}{X} + a^{-\beta} Y^2 \pdv{u\left( X,\: Y \right)}{Y}                       & = 0.
    \end{align*}
    For this PDE to be invariant under a dilation transformation, we
    must again factor out \(a\) from the equation so that:
    \begin{equation*}
        a = a^{-\beta} \implies 1 = -\beta \implies \beta = -1,
    \end{equation*}
    and
    \begin{equation*}
        \pdv{u\left( X,\: Y \right)}{X} + Y^2 \pdv{u\left( X,\: Y \right)}{Y} = 0.
    \end{equation*}
    Here we have shown that this nonlinear PDE is invariant under the
    above dilation transformation when \(\beta = -1\).
\end{example}
\begin{example}
    Consider the nonlinear convection diffusion equation
    \begin{equation*}
        \pdv{u\left( x,\: t \right)}{t} = u\left( x,\: t \right) \pdv[order=2]{u\left( x,\: t \right)}{x} - \pdv{u\left( x,\: t \right)}{x}
    \end{equation*}
    and the mapping
    \begin{equation*}
        X = a x, \quad T = a^\beta t, \quad U = a^\gamma u.
    \end{equation*}
    We will once again substitute the transformed solution into the PDE
    to find
    \begin{align*}
        a^\gamma \pdv{u\left( X,\: T \right)}{t}            & = a^{2\gamma} u\left( X,\: T \right) \pdv[order=2]{u\left( X,\: T \right)}{x} - a^\gamma \pdv{u\left( X,\: T \right)}{x}                                       \\
        a^\gamma \pdv{u\left( X,\: T \right)}{T} \odv{T}{t} & = a^{2\gamma} u\left( X,\: T \right) \pdv*{\left[ \pdv{u\left( X,\: T \right)}{X} \odv{X}{x} \right]}{x} - a^\gamma \pdv{u\left( X,\: T \right)}{X} \odv{X}{x} \\
        a^{\beta + \gamma} \pdv{u\left( X,\: T \right)}{T}  & = a^{1 + 2\gamma} u\left( X,\: T \right) \pdv*{\left[ \odv{X}{x} \pdv{u\left( X,\: T \right)}{X} \right]}{X} - a^{1 + \gamma} \pdv{u\left( X,\: T \right)}{X}  \\
        a^{\beta + \gamma} \pdv{u\left( X,\: T \right)}{T}  & = a^{2 + 2\gamma} u\left( X,\: T \right) \pdv[order=2]{u\left( X,\: T \right)}{X} - a^{1 + \gamma} \pdv{u\left( X,\: T \right)}{X}.
    \end{align*}
    For this PDE to be invariant under a dilation transformation, we
    must factor out \(a\) from the equation so that:
    \begin{equation*}
        a^{\beta + \gamma} = a^{2 + 2\gamma} = a^{1 + \gamma} \implies \beta + \gamma = 2 + 2\gamma = 1 + \gamma \implies \beta = 1, \gamma = -1,
    \end{equation*}
    and
    \begin{equation*}
        \pdv{u\left( X,\: T \right)}{T} = u\left( X,\: T \right) \pdv[order=2]{u\left( X,\: T \right)}{X} - \pdv{u\left( X,\: T \right)}{X}.
    \end{equation*}
    Here we have shown that this nonlinear PDE is invariant under the
    above dilation transformation when \(\beta = 1\) and \(\gamma = -1\).
\end{example}
\subsection{Translation Symmetry}
A translation symmetry is a transformation of the form
\begin{equation*}
    X = x - x_0, \quad T = t - t_0, \quad U = u - u_0,
\end{equation*}
where \(x_0\), \(t_0\), and \(u_0\) are constants.
\begin{example}
    Consider the heat equation
    \begin{equation*}
        \pdv{u\left( x,\: t \right)}{t} = D \pdv[order=2]{u\left( x,\: t \right)}{x}
    \end{equation*}
    and the mapping
    \begin{equation*}
        X = x - x_0, \quad T = t - t_0, \quad U = u - u_0.
    \end{equation*}
    By substituting the transformed solution into the PDE, we find
    \begin{align*}
        \pdv*{\left( u\left( X,\: T \right) - u_0 \right)}{t} & = D \pdv*[order=2]{\left( u\left( X,\: T \right) - u_0 \right)}{x}      \\
        \pdv{u\left( X,\: T \right)}{T} \odv{T}{t}            & = D \pdv*{\left( \pdv{u\left( X,\: T \right)}{X} \odv{X}{x} \right)}{x} \\
        \pdv{u\left( X,\: T \right)}{T}                       & = D \pdv{}{X} \odv{X}{x} \left( \pdv{u\left( X,\: T \right)}{X} \right) \\
        \pdv{u\left( X,\: T \right)}{T}                       & = D \pdv[order=2]{u\left( X,\: T \right)}{X}.
    \end{align*}
    Here we have shown that the heat equation is invariant under the
    above translation transformation.
\end{example}
\section{Similarity Solutions}
In the previous section, we considered dilation transformations where
both independent variables were scaled by some power of \(a\). Notice
that the product \(\eta = x t^{-1/\beta}\) is invariant under the same
dilation transformation:
\begin{align*}
    \eta = x t^{-1/\beta} \implies H = \left( \frac{x}{a} \right) \left( \frac{T}{a^\beta} \right)^{-1/\beta} = X T^{-1/\beta}.
\end{align*}
Let us therefore consider transformations of the form
\begin{equation*}
    X = a x, \quad T = a^\beta t, \quad U = t^{-\alpha} f\left( \eta \right),
\end{equation*}
where \(a\), \(\alpha\), and \(\beta\) are constant and \(f\) is an arbitrary
function to be determined. \(f\) is called a \textit{similarity solution}
(with \textit{similarity variable} \(\eta\)) and our goal is to
transform the PDE into an ODE with a single independent variable \(\eta\).
To do this:
\begin{enumerate}
    \item Substitute \(u\left( X,\: T \right)\) into the PDE to solve
          for \(\alpha\) and \(\beta\) while maintaining invariance.
    \item Obtain an ODE in terms of \(f\left( \eta \right)\) by
          substituting the similarity solution into the PDE.
    \item Obtain boundary conditions in terms of \(\eta\) using the
          same transformation.
    \item Solve the ODE to find \(f\left( \eta \right)\).
    \item Transform back to the original variables to find a solution
          to the PDE.
\end{enumerate}
\section{Travelling Wave Solutions}
Another type of solution is the \textit{travelling wave solution},
where the solution to a PDE appears to move at a constant velocity when
after a long period of time. This is similar to a steady state solution
where the solution does not change after a long period of time. In this
problem, we assume solutions of the form
\begin{equation*}
    u\left( x,\: t \right) = f\left( z \right), \quad z = x - c t,
\end{equation*}
where \(c\) is the speed at which the solution travels. The travelling
wave speed is often determined using analysis, boundary conditions,
numerical methods, or physical constraints. This method is only
applicable to PDEs that are invariant under translations to both
independent variables. As such, the PDE must not contain any explicit
dependence on \(x\) or \(t\).
\part{Method of Characteristics}
The method of characteristics is a technique used to solve nonlinear
PDEs by reducing them to a system of ODEs. It considers
parametrisations of the solution through a set of curves in the
solution space along which the solution is constant.
\section{First Order PDEs}
\subsection{Linearity}
Consider the general first order PDE in two variables:
\begin{equation*}
    a \pdv{u}{x} + b \pdv{u}{y} = c.
\end{equation*}
This PDE has four classifications based on the value of the
variables \(a\), \(b\), and \(c\):
\begin{itemize}
    \item \textbf{Linear}:
          \begin{equation*}
              a\left( x,\: y \right) \pdv{u}{x} + b\left( x,\: y \right) \pdv{u}{y} = c\left( x,\: y \right).
          \end{equation*}
    \item \textbf{Semi-Linear}:
          \begin{equation*}
              a\left( x,\: y \right) \pdv{u}{x} + b\left( x,\: y \right) \pdv{u}{y} = c\left( x,\: y,\: u \right).
          \end{equation*}
    \item \textbf{Quasi-Linear}:
          \begin{equation*}
              a\left( x,\: y,\: u \right) \pdv{u}{x} + b\left( x,\: y,\: u \right) \pdv{u}{y} = c\left( x,\: y,\: u \right).
          \end{equation*}
    \item \textbf{Nonlinear}: Otherwise.
\end{itemize}
\subsection{Solution Method}
Consider a quasi-linear PDE of the form:
\begin{equation*}
    a\left( x,\: y,\: u \right) \pdv{u}{x} + b\left( x,\: y,\: u \right) \pdv{u}{y} = c\left( x,\: y,\: u \right)
\end{equation*}
with initial data \(u_0\left( x \right)\) and initial condition
\(u\left( x_0,\: y_0 \right) = u_0\left( x \right)\), where \(a\), \(b\),
and \(c\) are continuous functions in \(x\), \(y\), and \(u\). To reduce
this problem into a family of ODEs, we will consider the solution
surface \(u = u\left( x,\: y \right)\) on which the PDE is satisfied.
If we express is surface implicitly as \(f\left( x,\: y,\: u \right) = u\left( x,\: y \right) - u = 0\),
we find the following normal vector:
\begin{equation*}
    \symbf{n} = \symbf{\nabla} f =
    \begin{bmatrix}
        u_x \\
        u_y \\
        -1
    \end{bmatrix}
    .
\end{equation*}
We will also define the vector field \(\symbf{v}\) consisting of the
coefficients of this PDE:
\begin{equation*}
    \symbf{v} =
    \begin{bmatrix}
        a\left( x,\: y,\: u \right) \\
        b\left( x,\: y,\: u \right) \\
        c\left( x,\: y,\: u \right)
    \end{bmatrix}
\end{equation*}
so that we express the PDE as \(\symbf{v} \cdot \symbf{n} = 0\). As
\(\symbf{n}\) is normal to the solution surface \(u\left( x,\: y \right)\),
\(\symbf{v}\) must lie on the tangent plane to the solution surface.
This vector field is therefore known as the \textit{characteristic
    direction} of the PDE. Let us now consider a parametric curve defined as:
\begin{equation*}
    \symbf{r}\left( s \right) =
    \begin{bmatrix}
        x\left( s \right) \\
        y\left( s \right) \\
        u\left( s \right)
    \end{bmatrix}
    ,
\end{equation*}
and let us impose that it's tangent vector is equal to \(\symbf{v}\)
so that the curve also lies on the solution surface:
\begin{equation*}
    \symbf{r}'\left( s \right) = \symbf{v}.
\end{equation*}
Doing so yields the following system of ODEs:
\begin{align*}
    \displaystyle\pdv{x}{s} & = a\left( x,\: y,\: u \right), \\
    \displaystyle\pdv{y}{s} & = b\left( x,\: y,\: u \right), \\
    \displaystyle\pdv{u}{s} & = c\left( x,\: y,\: u \right).
\end{align*}
We can solve these parametric curves through integration and solve for
all integration constants \(x_0\), \(y_0\), and \(u_0\) using the
parametric initial condition:
\begin{equation*}
    u\left( 0 \right) = u_0\left( \xi \right) \quad \text{on} \quad x\left( 0 \right) = x_0\left( \xi \right) \quad \text{and} \quad y\left( 0 \right) = y_0\left(\xi \right).
\end{equation*}
where \(\xi\) parametrises the initial condition. The resulting parametric
equations \(x\left( s \right)\) and \(y\left( s \right)\) form
\textit{characteristics} for the PDE, which allows us to determine the
value of \(u\left( x,\: y \right)\) along the curve for specific values
of \(\xi\). The solution \(u\left( x,\: y \right)\) can then be found by
eliminating \(s\) and \(\xi\) from the three parametric equations.
\subsection{Characteristic Curves}
After determining characteristics for a PDE, we can plot these
parametric curves in the \(x\)-\(y\) plane to determine regions where
the solution is constant. We do so by considering the \textit{domain of
dependence} for points in each region to determine the value of the
solution \(u\) by walking backward along these curves. Doing so allows
us to understand how the solution behaves along different
characteristics without needing to plot the entire solution surface.
\subsubsection{Expansion Waves}
Consider a quasi-linear PDE of the form
\begin{equation*}
    a\left( x,\: t,\: u \right) \pdv{u}{x} + \pdv{u}{t} = c\left( x,\: t,\: u \right)
\end{equation*}
with some initial condition. If this initial condition causes
characteristics to change slope when \(x_0 = 0\), so that they fan
outwards from this point, the region is called an \textit{expansion wave}.
For the solution to be defined at all points, we assume that
\(u\left( x_0,\: 0 \right)\) takes all values between \(u\left( x_0^-,\: 0 \right)\) and \(u\left( x_0^+,\: 0 \right)\),
on \(x\left( s \right)\). This means that as time increases, the
discontinuity in the initial condition spreads along the \(x\)-axis.
\subsubsection{Shock Waves}
Consider a quasi-linear PDE of the form
\begin{equation*}
    a\left( x,\: t,\: u \right) \pdv{u}{x} + \pdv{u}{t} = c\left( x,\: t,\: u \right)
\end{equation*}
with some initial condition. If this initial condition causes
characteristics to change slope at the point \(x_0 = 0\), where the
slopes of characteristics for \(x_0 < 0\) are steeper than those when
\(x_0 > 0\), we have an intersection of characteristics.
This results in a \textit{shock} in the solution, so that the solution
overtakes itself as time increases, leading to a multi-valued solution.
\section{System of First Order PDEs}
Consider an \(n \times n\) coupled system of first order PDEs:
\begin{equation*}
    \symbf{A} \pdv{\symbf{u}}{x} + \symbf{B} \pdv{\symbf{u}}{y} = \symbf{c}, \quad \text{with} \quad \symbf{u}\left( x_0,\: y_0 \right) = \symbf{u}_0\left( x \right),
\end{equation*}
where \(\symbf{A} = \symbf{A}\left( x,\: y,\: \symbf{u} \right)\) and
\(\symbf{B} = \symbf{B}\left( x,\: y,\: \symbf{u} \right)\) are
\(n \times n\) matrix functions, and
\(\symbf{c} = \symbf{c}\left( x,\: y,\: \symbf{u} \right)\) is an
\(n \times 1\) vector function.
In this case, we want to find characteristic directions \(\symbf{v}\)
that will allow us to decouple the system into first order ODEs. Let us
try to decompose \(\symbf{A}\) and \(\symbf{B}\) into a diagonal form by
assuming the following relationship holds for some \(\symbf{m}\):
\begin{equation*}
    \symbf{v}^\top \left( \symbf{A} \pdv{\symbf{u}}{x} + \symbf{B} \pdv{\symbf{u}}{y} \right) = \symbf{m}^\top \left( \alpha \pdv{\symbf{u}}{x} + \beta \pdv{\symbf{u}}{y} \right),
\end{equation*}
where \(\symbf{v}\) and \(\symbf{m}\) are \(n \times 1\) vector
functions, and \(\alpha = \odv{x}{s}\) and \(\beta = \odv{y}{s}\) are
scalar parametric functions. For this to hold, we must have:
\begin{equation*}
    \symbf{v}^\top \symbf{A} = \symbf{m}^\top \alpha \quad \text{and} \quad \symbf{v}^\top \symbf{B} = \symbf{m}^\top \beta.
\end{equation*}
By eliminating \(\symbf{m}^\top\), we find the following relationship
between \(\symbf{A}\) and \(\symbf{B}\):
\begin{align*}
    \frac{1}{\alpha} \symbf{v}^\top \symbf{A} & = \frac{1}{\beta} \symbf{v}^\top \symbf{B}      \\
    \symbf{v}^\top \symbf{A}                  & = \frac{\alpha}{\beta} \symbf{v}^\top \symbf{B} \\
    \symbf{v}^\top \symbf{A}                  & = \lambda \symbf{v}^\top \symbf{B}.
\end{align*}
This is precisely the left-generalised eigenvalue problem for the matrix
pair \(\left( \symbf{A},\: \symbf{B} \right)\) where the eigenvalues
\(\lambda_i\) are found by solving the characteristic equation:
\begin{equation*}
    \det{\left( \symbf{A} - \lambda \symbf{B} \right)} = 0.
\end{equation*}
Assuming a diagonalisable system, we have the following matrix
decomposition:
\begin{equation*}
    \symbf{A} = \symbf{B} \symbf{V} \symbf{\Lambda} \symbf{V}^{-1},
\end{equation*}
where \(\symbf{V}\) is the matrix of eigenvectors and \(\symbf{\Lambda}\)
is the diagonal matrix of eigenvalues. If we assume a solution of the
form \(\symbf{u} = \symbf{V} \symbf{w}\), we can transform the system
of PDEs into a diagonal form:
\begin{align*}
    \symbf{A} \pdv{\symbf{u}}{x} + \symbf{B} \pdv{\symbf{u}}{y}                                                                             & = \symbf{c}                                \\
    \left( \symbf{B} \symbf{V} \symbf{\Lambda} \symbf{V}^{-1} \right) \symbf{V} \pdv{\symbf{w}}{x} + \symbf{B} \symbf{V} \pdv{\symbf{w}}{y} & = \symbf{c}                                \\
    \symbf{B} \symbf{V} \symbf{\Lambda} \pdv{\symbf{w}}{x} + \symbf{B} \symbf{V} \pdv{\symbf{w}}{y}                                         & = \symbf{c}                                \\
    \symbf{\Lambda} \pdv{\symbf{w}}{x} + \pdv{\symbf{w}}{y}                                                                                 & = \symbf{V}^{-1} \symbf{B}^{-1} \symbf{c},
\end{align*}
where we assume \(\symbf{B}\) is invertible. Here the initial conditions
for \(\symbf{w}\) are determined by the initial conditions for
\(\symbf{u}\):
\begin{equation*}
    \symbf{w}\left( x_0,\: y_0 \right) = \symbf{V}^{-1} \symbf{u}_0\left( x \right).
\end{equation*}
As \(\symbf{\Lambda}\) is diagonal, we can form a system of \(n\) first
order PDEs which can be solved independently to find \(w_i\left( x,\: y \right)\),
allowing us to find the solution \(\symbf{u}\left( x,\: y \right)\).
\section{Second Order PDEs}
Consider the general linear second order PDE in two variables:
\begin{equation*}
    a \pdv[order=2]{u}{x} + 2b \pdv{u}{x,y} + c \pdv[order=2]{u}{y} + d \pdv{u}{x} + e \pdv{u}{y} = f.
\end{equation*}
with the initial conditions \(u\left( x_0,\: y_0 \right) = f\left( x \right)\)
and \(u_y\left( x_0,\: y_0 \right) = g\left( x \right)\) where variables
\(a\) through \(f\) are functions of \(x\) and \(y\) only. We will begin
by factoring this PDE into it's two first derivatives
\(u_x = \pdv{u}{x}\) and \(u_y = \pdv{u}{y}\) to convert the second
order PDE into a system of first order PDEs:
\begin{align*}
    a \pdv[order=2]{u}{x} + 2b \pdv{u}{y,x} + c \pdv[order=2]{u}{y} + d \pdv{u}{x} + e \pdv{u}{y} & = f                  \\
    a \pdv{u_x}{x} + 2b \pdv{u_x}{y} + c \pdv{u_y}{y} + d u_x + e u_y                             & = f                  \\
    a \pdv{u_x}{x} + 2b \pdv{u_x}{y} + c \pdv{u_y}{y}                                             & = f - d u_x - e u_y.
\end{align*}
Additionally, we will assume that Schwarz's theorem holds:
\begin{equation*}
    \pdv{u}{y,x} = \pdv{u}{x,y} \iff \pdv{u_x}{y} = \pdv{u_y}{x}.
\end{equation*}
This allows us to form the following system of first order PDEs:
\begin{equation*}
    \begin{bmatrix}
        a & 0 \\
        0 & 1
    \end{bmatrix}
    \pdv{}{x}
    \begin{bmatrix}
        u_x \\
        u_y
    \end{bmatrix}
    +
    \begin{bmatrix}
        2b & c \\
        -1 & 0
    \end{bmatrix}
    \pdv{}{y}
    \begin{bmatrix}
        u_x \\
        u_y
    \end{bmatrix}
    =
    \begin{bmatrix}
        f - d u_x - e u_y \\
        0
    \end{bmatrix}
    ,
\end{equation*}
which can be solved using the process described in the previous section,
where the initial condition for \(u_x\) is simply
\(u_x\left( x_0,\: y_0 \right) = f'\left( x \right)\).
\subsection{Classification of Second Order PDEs}
Using the above form, we can determine the characteristic equation for
a second order PDE:
\begin{equation*}
    \begin{vmatrix}
        a - 2b \lambda & -c       \\
        1              & -\lambda
    \end{vmatrix}
    = a \lambda^2 - 2b \lambda + c = 0,
\end{equation*}
where the eigenvalues \(\lambda\) are given by:
\begin{equation*}
    \lambda = \frac{2b \pm \sqrt{4b^2 - 4ac}}{2a} = \frac{b \pm \sqrt{b^2 - ac}}{a}.
\end{equation*}
We can classify this second order PDE into 3 types based on the sign of
the discriminant \(b^2 - ac\):
\begin{itemize}
    \item \textbf{Hyperbolic}: (two real distinct eigenvalues)
          \begin{equation*}
              b^2 - ac > 0.
          \end{equation*}
    \item \textbf{Parabolic}: (two real equal eigenvalues)
          \begin{equation*}
              b^2 - ac = 0.
          \end{equation*}
    \item \textbf{Elliptic}: (two complex eigenvalues)
          \begin{equation*}
              b^2 - ac < 0.
          \end{equation*}
\end{itemize}
\subsection{D'Alembert's Solution}
D'Alembert's solution is a general solution to the one-dimensional wave
equation
\begin{equation*}
    \pdv[order=2]{u}{t} = c^2 \pdv[order=2]{u}{x}, \quad -\infty < x < \infty, \quad t > 0,
\end{equation*}
with initial conditions \(u\left( x,\: 0 \right) = f\left( x \right)\)
and \(u_t\left( x,\: 0 \right) = g\left( x \right)\). Using the
techniques above, it can be shown that the general solution to this PDE
has the form:
\begin{equation*}
    u\left( x,\: t \right) = \frac{1}{2} \left[ f\left( x + c t \right) + f\left( x - c t \right) \right] + \frac{1}{2c} \int_{x - c t}^{x + c t} g\left( s \right) \odif{s}.
\end{equation*}
\section{Conservation of Mass}\label{sec:conservation-of-mass}
Consider the flow of some mass in a one-dimensional channel between \(x
= a\) and \(x = b\). Let \(v = v\left( x,\: t \right)\) be the velocity
of the flow, and \(\rho = \rho\left( x,\: t \right)\) be the density of
the flow, where velocity has units: length per time, and density has
units: mass over volume. Then, the mass flux \(q = q\left( x,\: t
\right)\) is defined as \(q = \rho v\), which has units: mass per unit
time per unit area.

The mass of the fluid per unit area between \(x = a\) and \(x = b\) is
given by the integral,
\begin{equation*}
    \int_a^b \rho \odif{x}.
\end{equation*}
Additionally, this mass is a dynamic quantity that depends on the flux
in at \(x = a\) given by:
\begin{equation*}
    \left. q \right|_{x = a}
\end{equation*}
and the mass flux out at \(x = b\) given by:
\begin{equation*}
    \left. q \right|_{x = b}.
\end{equation*}
The conservation of mass argument for this mass is a relationship
between these fluxes and the rate of change of mass in the channel:
\begin{align*}
    \odv*{\int_a^b \rho \odif{x}}{t}                & = \left. q \right|_{x = a} - \left. q \right|_{x = b} \\
    \int_a^b \pdv{\rho}{t} \odif{x}                 & = \int_b^a \pdv{q}{x} \odif{x}                        \\
    \int_a^b \pdv{\rho}{t} \odif{x}                 & = - \int_a^b \pdv{q}{x} \odif{x}                      \\
    \pdv{\rho}{t}                                   & = - \pdv{q}{x}                                        \\
    \pdv{\rho}{t} + \pdv{q}{x}                      & = 0                                                   \\
    \pdv{\rho}{t} + \pdv*{\left( \rho v \right)}{x} & = 0.
\end{align*}
We can also allow \(a\) and \(b\) to be functions of time, where we can
apply Leibniz integral rule to arrive at the same result on the interval
\(a\left( t \right) < x < b\left( t \right)\).
\subsection{Traffic Flow}
Consider a simple model for traffic flow where \(\rho\) is the density
of the flow of cars (number of cars per unit length), and \(q\) is the
flux of cars (number of cars per unit time), where \(q = \rho v\)
(\(v\) velocity). The number of cars between \(x = a\) and \(x = b\) is
given by:
\begin{equation*}
    \int_a^b \rho \odif{x},
\end{equation*}
the flux of cars in at \(x = a\) is given by \(\left. q \right|_{x = a}\),
and the flux of cars out at \(x = b\) is given by \(\left. q \right|_{x = b}\).
Then, for the conservation of the number of cars, we must have that:
\begin{equation*}
    \pdv{\rho}{t} + \pdv{q}{x} = 0.
\end{equation*}
This model is a PDE with two unknown variables, \(\rho\) and \(q\).
To close this system, we must introduce a constitutive relationship
between \(\rho\) and \(q\) (or between \(\rho\) and \(v\)), which is
determined through empirical analysis.
\subsection{Shock Solutions}
If a quasi-linear PDE inhibits a shock wave, and we desire a
single-valued solution instead, we can introduce a discontinuity in the
solution. To do so, we must assume that the total flow \(q = u v\) is
conserved across the \textit{shock wave} \(x_s\left( t \right)\), so
that the flow from the left into the moving shock wave equals the flow
to the right away from the shock wave.

Suppose conservation of mass holds between \(x = a\) and \(x = b\),
except at a shock wave at \(x = x_s\left( t \right)\), across which
both \(u\) and \(q\) are discontinuous. We can still expect a weak form
of conservation of mass to hold across the shock wave,
\begin{equation*}
    \odv*{\int_a^b u \odif{x}}{t} = \left. q \right|_{x = a} - \left. q \right|_{x = b}.
\end{equation*}
Consider dividing this integral into two regions that do not contain
the shock wave. Then, using Leibniz's rule, we find
\begin{align*}
    \odv*{\int_a^b u \odif{x}}{t} & = \odv*{\int_a^{x_s^{-}\left( t \right)} u \odif{x}}{t} + \odv*{\int_{x_s^{+}\left( t \right)}^b u \odif{x}}{t}                                                                                       \\
                                  & = \int_a^{x_s^{-}\left( t \right)} \pdv{u}{t} \odif{x} + \left. u \right|_{x = x^{-}} \odv{x_s}{t} + \int_{x_s^{+}\left( t \right)}^b \pdv{u}{t} \odif{x} - \left. u \right|_{x = x^{+}} \odv{x_s}{t}
\end{align*}
For the RHS, we can use the fundamental theorem of calculus to find:
\begin{align*}
    \left. q \right|_{x = a} - \left. q \right|_{x = b} & = \left. q \right|_{x = a} - \left. q \right|_{x = x^{-}} + \left. q \right|_{x = x^{+}} - \left. q \right|_{x = b} + \left. q \right|_{x = x^{-}} - \left. q \right|_{x = x^{+}} \\
                                                        & = \left. q \right|_{x = x^{-}}^{x = a} + \left. q \right|_{x = b}^{x = x^{+}} + \left. q \right|_{x = x^{-}} - \left. q \right|_{x = x^{+}}                                       \\
                                                        & = \int_{x_s^{-}\left( t \right)}^a \pdv{q}{x} \odif{x} + \int_b^{x_s^{+}\left( t \right)} \pdv{q}{x} \odif{x} + \left. q \right|_{x = x^{-}} - \left. q \right|_{x = x^{+}}       \\
                                                        & = -\int_a^{x_s^{-}\left( t \right)} \pdv{q}{x} \odif{x} - \int_{x_s^{+}\left( t \right)}^b \pdv{q}{x} \odif{x} + \left. q \right|_{x = x^{-}} - \left. q \right|_{x = x^{+}}.
\end{align*}
By equating the LHS and RHS, we find
\begin{align*}
    \int_a^{x_s^{-}\left( t \right)} \pdv{u}{t} + \pdv{q}{x} \odif{x} + \int_{x_s^{+}\left( t \right)}^b \pdv{u}{t} + \pdv{q}{x} \odif{x} + \left. u \right|_{x = x^{-}} \odv{x_s}{t} - \left. u \right|_{x = x^{+}} \odv{x_s}{t} & = \left. q \right|_{x = x^{-}} - \left. q \right|_{x = x^{+}}                                                                      \\
    \odv{x_s}{t} \left[ \left. u \right|_{x = x^{-}} - \left. u \right|_{x = x^{+}} \right]                                                                                                                                       & = \left. q \right|_{x = x^{-}} - \left. q \right|_{x = x^{+}}                                                                      \\
    \odv{x_s}{t}                                                                                                                                                                                                                  & = \frac{\left. q \right|_{x = x^{-}} - \left. q \right|_{x = x^{+}}}{\left. u \right|_{x = x^{-}} - \left. u \right|_{x = x^{+}}}.
\end{align*}
Or, more compactly,
\begin{equation*}
    x_s'\left( t \right) = \frac{q^+ - q^-}{u^+ - u^-} = \frac{\left[ q \right]}{\left[ u \right]} = \frac{\text{jump in flow}}{\text{jump in value}}.
\end{equation*}
By solving for the shock wave \(x_s\left( t \right)\), we can divide
the solution into two regions, one on either side of the shock wave.
Characteristics will then meet at this shock wave leading to a
single-valued solution. Note this solution does not have a derivative at
the shock wave, and the shock solution is not unique.
\subsection{Caustics}
If the characteristics of a PDE intersect along some curve not arising
from the \(x\)-axis, we have a \textit{caustic}. Such characteristics
may lead to more than 2 values for the solution. When determining a
shock solution for such cases, we must consider the time \(t_s\) at
which the solution first becomes multi-valued. \(t_s\) is the time at
which the slope:
\begin{equation*}
    \pdv{u}{x} = \frac{\pdv{u}{\xi}}{\pdv{x\left( s \right)}{\xi}}
\end{equation*}
becomes infinite. This can be found by solving for the value of \(s\) at
which the denominator of the above expression becomes zero. If we call
this value \(s_{\text{caustic}}\), we can parametrically define the
caustic as:
\begin{equation*}
    \symbf{x}_{\text{caustic}}\left( \xi \right) =
    \begin{bmatrix}
        x\left( s_{\text{caustic}} \right) \\
        t\left( s_{\text{caustic}} \right)
    \end{bmatrix}
    =
    \begin{bmatrix}
        x_{\text{caustic}} \left( \xi \right) \\
        t_{\text{caustic}} \left( \xi \right)
    \end{bmatrix}
\end{equation*}
We can then use the tangent vector \(\symbf{x}_{\text{caustic}}'\left( \xi \right)\)
to determine the minimum of this curve to find the first time \(t_s\) at
which the solution becomes multi-valued. When solving for the shock
\(x_s\left( t \right)\) as outlined in the previous section, we can use
this initial value to find the constant of integration.
\subsection{Higher-Order Terms}
If we wish for a shock to be resolved without a jump discontinuity, we
can introduce higher-order terms into the PDE that will smooth out the
solution.
\part{Incompressible Fluid Flow}
In the following sections, we will discuss the flow of incompressible
Newtonian fluids. We will begin by deriving the governing equations for
fluid flow using methods from continuum mechanics. Here we treat fluids
as continuous media, where fluid properties are described by fields
that vary continuously in space and time. We will then introduce ideal
fluid flow, where we assume a fluid is inviscid and incompressible, and
derive the Euler equations.
\section{Continuum Mechanics}
\subsection{Material Derivative}
Consider the temporal rate of change of a quantity which follows the
motion of a fluid particle at position \(\symbf{r}\left( x,\: y,\: z,\:
t \right)\). We cannot simply take the partial derivative of the field
with respect to time as it is not fixed in space. Instead, we will
introduce the \textit{material derivative}, which accounts for the
change in a field as a fluid particle moves through space. We will
motivate this definition by deriving the acceleration of a fluid
particle. Using the limit definition of the derivative, we find:
\begin{equation*}
    \symbf{a}\left( x,\: y,\: z,\: t \right) = \lim_{\adif{t} \to 0} \frac{\symbf{q}\left( x + \adif{x},\: y + \adif{y},\: z + \adif{z},\: t + \adif{t} \right) - \symbf{q}\left( x,\: y,\: z,\: t \right)}{\Delta t},
\end{equation*}
where \(\symbf{q}\) is the velocity field of the fluid, defined:
\begin{equation*}
    \symbf{q}\left( x,\: y,\: z,\: t \right) =
    \begin{bmatrix}
        u\left( x,\: y,\: z,\: t \right) \\
        v\left( x,\: y,\: z,\: t \right) \\
        w\left( x,\: y,\: z,\: t \right)
    \end{bmatrix}
    =
    \odv{\symbf{r}}{t}.
\end{equation*}
Notice that a small step in time has also resulted in a small step in
space. Let us therefore use the Taylor series expansion of the velocity
field to simplify the numerator of the above expression to:
\begin{equation*}
    \symbf{q}\left( x + \adif{x},\: y + \adif{y},\: z + \adif{z},\: t + \adif{t} \right) = \symbf{q}\left( x,\: y,\: z,\: t \right) + \pdv{\symbf{q}}{x} \adif{x} + \pdv{\symbf{q}}{y} \adif{y} + \pdv{\symbf{q}}{z} \adif{z} + \pdv{\symbf{q}}{t} \adif{t} + \ldots,
\end{equation*}
where we are evaluating the velocity field at the point \(\left( x,\:
y,\: z,\: t \right)\). Substituting this into the numerator, we find:
\begin{align*}
    \symbf{a}\left( x,\: y,\: z,\: t \right) & = \lim_{\adif{t} \to 0} \left[ \pdv{\symbf{q}}{x} \adv{x}{t} + \pdv{\symbf{q}}{y} \adv{y}{t} + \pdv{\symbf{q}}{z} \adv{z}{t} + \pdv{\symbf{q}}{t} + \ldots \right] \\
                                             & = \pdv{\symbf{q}}{x} \odv{x}{t} + \pdv{\symbf{q}}{y} \odv{y}{t} + \pdv{\symbf{q}}{z} \odv{z}{t} + \pdv{\symbf{q}}{t}                                               \\
                                             & = \pdv{\symbf{q}}{x} u + \pdv{\symbf{q}}{y} v + \pdv{\symbf{q}}{z} w + \pdv{\symbf{q}}{t}                                                                          \\
                                             & = \pdv{\symbf{q}}{t} + u \pdv{\symbf{q}}{x} + v \pdv{\symbf{q}}{y} + w \pdv{\symbf{q}}{z}                                                                          \\
                                             & = \pdv{\symbf{q}}{t} + \left( u \pdv{}{x} + v \pdv{}{y} + w \pdv{}{z} \right) \symbf{q}                                                                            \\
                                             & = \pdv{\symbf{q}}{t} + \left( \symbf{q} \cdot \symbf{\nabla} \right) \symbf{q}.
\end{align*}
\begin{definition}[Material Derivative]
    The rate of change of a quantity as observed from a moving reference
    frame following a fluid particle can be expressed as the material
    derivative of the quantity. This operator is denoted as:
    \begin{equation*}
        \mdv{}{t} = \pdv{}{t} + \symbf{q} \cdot \symbf{\nabla}.
    \end{equation*}
\end{definition}
Therefore, we can express the acceleration of a fluid particle in a
moving reference frame as:
\begin{equation*}
    \symbf{a} = \mdv{\symbf{q}}{t}.
\end{equation*}
\subsection{Conservation of Mass}
Let us now consider what a conservation of mass argument would look
like for a fluid. For a control volume \(V\), the total mass of the
fluid is given by the integral:
\begin{equation*}
    M = \iiint_V \rho \odif{V},
\end{equation*}
where \(\rho = \rho\left( x,\: y,\: z,\: t \right)\) is the density of
the fluid. As we saw in the previous
section, we want the rate of change of mass to be equal to the net flux
of fluid into the control volume. This can be expressed using a surface
integral over the surface of the control volume:
\begin{equation*}
    \odv{M}{t} = -\oiint_{\partial V} \rho \left( \symbf{q} \cdot \symbf{n} \right) \odif{\symbf{\sigma}},
\end{equation*}
where \(\symbf{n}\) is the outward unit normal vector to the surface of
the control volume, and \(\odif{\symbf{\sigma}}\) is the differential
area element. By applying the divergence theorem, we can rewrite this
surface integral as:
\begin{equation*}
    \odv*{\iiint_V \rho \odif{V}}{t} = -\iiint_V \symbf{\nabla} \cdot \left( \rho \symbf{q} \right) \odif{V}.
\end{equation*}
As the control volume is arbitrary and fixed, we can apply Leibniz's
integral rule to find:
\begin{align*}
    \iiint_V \pdv{\rho}{t} \odif{V} + \iiint_V \symbf{\nabla} \cdot \left( \rho \symbf{q} \right) \odif{V} & = 0  \\
    \iiint_V \left( \pdv{\rho}{t} + \symbf{\nabla} \cdot \left( \rho \symbf{q} \right) \right) \odif{V}    & = 0  \\
    \pdv{\rho}{t} + \symbf{\nabla} \cdot \left( \rho \symbf{q} \right)                                     & = 0.
\end{align*}
We can alternatively express this in terms of the material derivative,
by expanding the divergence term:
\begin{align*}
    \pdv{\rho}{t} + \symbf{\nabla} \cdot \left( \rho \symbf{q} \right)                                                        & = 0  \\
    \pdv{\rho}{t} + \odv{\rho u}{x} + \odv{\rho v}{y} + \odv{\rho w}{z}                                                       & = 0  \\
    \pdv{\rho}{t} + \odv{\rho}{x} u + \rho \odv{u}{x} + \odv{\rho}{y} v + \rho \odv{v}{y} + \odv{\rho}{z} w + \rho \odv{w}{z} & = 0  \\
    \pdv{\rho}{t} + \odv{\rho}{x} u + \odv{\rho}{y} v + \odv{\rho}{z} w + \rho \odv{u}{x} + \rho \odv{v}{y} + \rho \odv{w}{z} & = 0  \\
    \pdv{\rho}{t} + \symbf{\nabla} \rho \cdot \symbf{q} + \rho \symbf{\nabla} \cdot \symbf{q}                                 & = 0  \\
    \mdv{\rho}{t} + \rho \symbf{\nabla} \cdot \symbf{q}                                                                       & = 0.
\end{align*}
This result is known as the \textit{continuity equation} and expresses
the conservation of mass for a fluid.
\subsection{Conservation of Momentum}
Let us now consider the conservation of momentum for a fluid. Using
Newton's second law of motion, we can express the rate of change in
momentum as the sum of the forces acting on the fluid. For a control
volume \(V\), the rate of change in momentum of a fluid is given by the
integral:
\begin{equation*}
    \odv*{\iiint_V \rho \symbf{q} \odif{V}}{t} = \symbf{F}.
\end{equation*}
Here, \(\symbf{F}\) is the total force acting on the fluid, per unit
volume. In a fluid, we can decompose this force into the sum of
\textbf{body forces} \(\symbf{F}_b\), and \textbf{surface forces}
\(\symbf{F}_s\), that act on some differential fluid element \(\odif{V}\).
Body forces are uniformly distributed through an element and can
include gravitational forces, electromagnetic forces, Coriolis forces,
etc. Here we will denote this generally as:
\begin{equation*}
    \odif{\symbf{F}_b} = \rho \symbf{g} \odif{V} \implies \symbf{F}_b = \iiint_V \rho \symbf{g} \odif{V},
\end{equation*}
where \(\symbf{g}\) is the acceleration due to some external body force.
Note that we do not multiply this by the mass of the fluid element, as
we are considering the force per unit volume. Surface forces act on the
surface of the fluid element and include pressure and viscous forces.
Here we will introduce the \textbf{total stress tensor} \(\symbf{\sigma}\)
which is the sum of \textbf{viscous stresses} \(\symbf{\tau}\) that
act both tangentially and normally to the surface of the fluid element,
and hydrostatic \textbf{pressures} \(p\) that act normally to the
surface of the fluid element. We can express this in component form as:
\begin{equation*}
    \sigma_{ij} = -p \delta_{ij} + \tau_{ij},
\end{equation*}
where \(\delta_{ij}\) is the Kronecker delta, or, using matrix notation:
\begin{align*}
    \begin{bmatrix}
        \sigma_{xx} & \sigma_{yx} & \sigma_{zx} \\
        \sigma_{xy} & \sigma_{yy} & \sigma_{zy} \\
        \sigma_{xz} & \sigma_{yz} & \sigma_{zz}
    \end{bmatrix}
                   & =
    \begin{bmatrix}
        -p + \tau_{xx} & \tau_{yx}      & \tau_{zx}      \\
        \tau_{xy}      & -p + \tau_{yy} & \tau_{zy}      \\
        \tau_{xz}      & \tau_{yz}      & -p + \tau_{zz}
    \end{bmatrix}
    \\
    \symbf{\sigma} & = -p \symbf{I} + \symbf{\tau}.
\end{align*}
The subscript \(\sigma_{ij}\) denotes a stress in the \(j\) direction
acting on a surface element with normal in the \(i\) direction. To find
the total surface force acting on a fluid element, consider all the
forces acting in the \(x\)-direction:
\begin{equation*}
    \odif{\symbf{F}_{sx}} = \left( - \sigma_{xx} + \sigma_{x+\adif{x},x} \right) \adif{y} \adif{z} + \left( - \sigma_{yx} + \sigma_{y+\adif{y},x} \right) \adif{x} \adif{z} + \left( - \sigma_{zx} + \sigma_{z+\adif{z},x} \right) \adif{x} \adif{y},
\end{equation*}
If we use the first-order Taylor expansion on these terms, this
simplifies to:
\begin{align*}
    \odif{\symbf{F}_{sx}} & = \pdv{\sigma_{xx}}{x} \adif{x} \adif{y} \adif{z} + \pdv{\sigma_{yx}}{y} \adif{y} \adif{x} \adif{z} + \pdv{\sigma_{zx}}{z} \adif{z} \adif{x} \adif{y} \\
                          & = \left( \pdv{\sigma_{xx}}{x} + \pdv{\sigma_{yx}}{y} + \pdv{\sigma_{zx}}{z} \right) \adif{V}.
\end{align*}
Therefore, for all three directions, we find:
\begin{align*}
    \odif{\symbf{F}_{sx}} & = \left( \pdv{\sigma_{xx}}{x} + \pdv{\sigma_{yx}}{y} + \pdv{\sigma_{zx}}{z} \right) \adif{V}, \\
    \odif{\symbf{F}_{sy}} & = \left( \pdv{\sigma_{xy}}{x} + \pdv{\sigma_{yy}}{y} + \pdv{\sigma_{zy}}{z} \right) \adif{V}, \\
    \odif{\symbf{F}_{sz}} & = \left( \pdv{\sigma_{xz}}{x} + \pdv{\sigma_{yz}}{y} + \pdv{\sigma_{zz}}{z} \right) \adif{V},
\end{align*}
written compactly as:
\begin{equation*}
    \odif{\symbf{F}_{si}} = \symbf{\nabla} \cdot \symbf{\sigma}_i^\top \odif{V}, \quad \text{where } \symbf{\sigma}_i = -p \symbf{e}_i^\top + \symbf{\tau}_i, \quad \text{for } i = x,\: y,\: z.
\end{equation*}
Here \(\symbf{\sigma}_i\) is the \(i\)-th row of the total stress tensor,
\(\symbf{e}_i\) is the \(i\)-th unit vector, and \(\symbf{\tau}_i\) is
the \(i\)-th row of the viscous stress tensor.
For Newtonian fluids, the viscous stress tensor can be related to the
velocity field of a fluid, by the \textit{Newtonian law of viscosity},
which states that the viscous stress is proportional to the rate of
strain of the fluid. This can be expressed as:
\begin{equation*}
    \tau_{ij} = \mu \left( \pdv{q_i}{x_j} + \pdv{q_j}{x_i} \right) \implies \symbf{\tau}_i = \mu
    \begin{bmatrix}
        \displaystyle \pdv{q_i}{x} + \pdv{u}{x_i} &
        \displaystyle \pdv{q_i}{y} + \pdv{v}{x_i} &
        \displaystyle \pdv{q_i}{z} + \pdv{w}{x_i}
    \end{bmatrix}
    ,
\end{equation*}
where \(\mu\) is the dynamic viscosity of the fluid and \(q_i\) is the
\(i\)-th component of the velocity field. This allows us to express the
total surface force acting on the fluid element in the \(i\)-th
direction as:
\begin{align*}
    \odif{\symbf{F}_{si}} & = \symbf{\nabla} \cdot \left( -p \symbf{e}_i + \symbf{\tau}_i^\top \right) \odif{V}                                          \\
                          & = \left( - \pdv{p}{x_i} + \symbf{\nabla} \cdot \symbf{\tau}_i^\top \right) \odif{V}                                          \\
                          & = \left( - \pdv{p}{x_i} + \mu \symbf{\nabla} \cdot
    \begin{bmatrix}
        \displaystyle \pdv{q_i}{x} + \pdv{u}{x_i} \\
        \displaystyle \pdv{q_i}{y} + \pdv{v}{x_i} \\
        \displaystyle \pdv{q_i}{z} + \pdv{w}{x_i}
    \end{bmatrix}
    \right) \odif{V}                                                                                                                                     \\
                          & = \left( - \pdv{p}{x_i} + \mu \left(
        \pdv[order=2]{q_i}{x} + \pdv{u}{x,x_i} +
        \pdv[order=2]{q_i}{y} + \pdv{v}{y,x_i} +
        \pdv[order=2]{q_i}{z} + \pdv{w}{z,x_i}
    \right) \right) \odif{V}                                                                                                                             \\
                          & = \left( - \pdv{p}{x_i} + \mu \left(
        \pdv[order=2]{q_i}{x} + \pdv[order=2]{q_i}{y} + \pdv[order=2]{q_i}{z} +
        \pdv{u}{x,x_i} + \pdv{v}{y,x_i} + \pdv{w}{z,x_i}
    \right) \right) \odif{V}                                                                                                                             \\
                          & = \left( - \pdv{p}{x_i} + \mu \nabla^2 q_i + \mu \symbf{\nabla} \cdot \pdv{\symbf{q}}{x_i} \right) \odif{V}                  \\
                          & = \left( - \pdv{p}{x_i} + \mu \nabla^2 q_i + \mu \pdv*{\left( \symbf{\nabla} \cdot \symbf{q} \right)}{x_i} \right) \odif{V}.
\end{align*}
By combining all three directions, we can write this using the gradient
operator:
\begin{equation*}
    \odif{\symbf{F}_s} = \left( -\symbf{\nabla} p + \mu \nabla^2 \symbf{q} + \mu \symbf{\nabla} \left( \symbf{\nabla} \cdot \symbf{q} \right) \right) \odif{V}.
\end{equation*}
By integrating this over the control volume, we find that the total
surface force acting on the fluid element is:
\begin{equation*}
    \symbf{F}_s = \iiint_V \left( -\symbf{\nabla} p + \mu \nabla^2 \symbf{q} + \mu \symbf{\nabla} \left( \symbf{\nabla} \cdot \symbf{q} \right) \right) \odif{V}.
\end{equation*}
Therefore, the conservation of momentum in a fluid can be expressed as:
\begin{align*}
    \odv*{\iiint_V \rho \symbf{q} \odif{V}}{t}        & = \symbf{F}_b + \symbf{F}_s                                                                                                                                     \\
    \iiint_V \mdv{\rho \symbf{q}}{t} \odif{V}         & = \iiint_V \left( \rho \symbf{g} -\symbf{\nabla} p + \mu \nabla^2 \symbf{q} + \mu \symbf{\nabla} \left( \symbf{\nabla} \cdot \symbf{q} \right) \right) \odif{V} \\
    \mdv{\rho}{t} \symbf{q} + \rho \mdv{\symbf{q}}{t} & = \rho \symbf{g} - \symbf{\nabla} p + \mu \nabla^2 \symbf{q} + \mu \symbf{\nabla} \left( \symbf{\nabla} \cdot \symbf{q} \right)                                 \\
\end{align*}
We can simplify the continuity equations by assuming that the density
of the fluid is constant so that \(\displaystyle\mdv{\rho}{t} = 0\).
Therefore, given the following constitutive relationship for an
incompressible fluid:
\begin{equation*}
    \symbf{\nabla} \cdot \symbf{q} = 0,
\end{equation*}
he governing equations for the flow of an incompressible Newtonian fluid
are:
\begin{equation*}
    \rho \mdv{\symbf{q}}{t} = \rho \symbf{g} - \symbf{\nabla} p + \mu \nabla^2 \symbf{q}.
\end{equation*}
These results are known as the \textit{Navier-Stokes equations} for an
incompressible fluid.
\section{Unidirectional Flow}
The Navier-Stokes equations are a nonlinear system of four PDEs that
are extremely difficult to solve both analytically and numerically.
However, by considering fluid flow in a single direction, we can
simplify this system greatly. Here we will orient our coordinate system
with the flow of the fluid, for example, in the \(x\)-direction. This
simplifies the velocity vector to:
\begin{equation*}
    u \neq 0, \quad v = 0, \quad w = 0.
\end{equation*}
The continuity equation then also simplifies to:
\begin{equation*}
    \symbf{\nabla} \cdot \symbf{q} = \pdv{u}{x} = 0 \implies u = u\left( y,\: z,\: t \right).
\end{equation*}
We can also simplify the material derivative to be used in the momentum
equation:
\begin{align*}
    \mdv{\symbf{q}}{t} & = \pdv{\symbf{q}}{t} + \left( \symbf{q} \cdot \symbf{\nabla} \right) \symbf{q} \\
                       & =
    \begin{bmatrix}
        \displaystyle\pdv{u}{t} \\
        0                       \\
        0
    \end{bmatrix}
    + \left( u \pdv{}{x} \right)
    \begin{bmatrix}
        u \\
        0 \\
        0
    \end{bmatrix}
    \\
                       & =
    \begin{bmatrix}
        \displaystyle\pdv{u}{t} + u \pdv{u}{x} \\
        0                                      \\
        0
    \end{bmatrix}
    \\
                       & =
    \begin{bmatrix}
        \displaystyle\pdv{u}{t} \\
        0                       \\
        0
    \end{bmatrix}
    .
\end{align*}
We can now consider each component of the Navier-Stokes equations using
these simplifications. The \(x\)-component of the Navier-Stokes
equations lets us cancel the derivatives of \(u\) in the \(x\) direction:
\begin{align*}
    \rho \pdv{u}{t} & = \rho g_x - \pdv{p}{x} + \mu \left( \pdv[order=2]{u}{x} + \pdv[order=2]{u}{y} + \pdv[order=2]{u}{z} \right) \\
    \rho \pdv{u}{t} & = \rho g_x - \pdv{p}{x} + \mu \left( \pdv[order=2]{u}{y} + \pdv[order=2]{u}{z} \right).
\end{align*}
In the \(y\)-component, we can cancel all derivatives of \(v\), as it is
zero:
\begin{align*}
    0 & = \rho g_y -\pdv{p}{y} + \mu \left( \pdv[order=2]{v}{x} + \pdv[order=2]{v}{y} + \pdv[order=2]{v}{z} \right) \\
    0 & = \rho g_y -\pdv{p}{y}.
\end{align*}
Finally, in the \(z\)-component, we can cancel all derivatives of \(w\),
as it is also zero:
\begin{align*}
    0 & = \rho g_z -\pdv{p}{z} + \mu \left( \pdv[order=2]{w}{x} + \pdv[order=2]{w}{y} + \pdv[order=2]{w}{z} \right) \\
    0 & = \rho g_z -\pdv{p}{z}.
\end{align*}
Therefore, the governing equations for unidirectional flow in the
\(x\)-direction is given by the following system of coupled PDEs:
\begin{equation*}
    \begin{cases}
        \displaystyle \rho \pdv{u}{t} = \rho g_x - \pdv{p}{x} + \mu \left( \pdv[order=2]{u}{y} + \pdv[order=2]{u}{z} \right) \\
        \displaystyle 0 = \rho g_y -\pdv{p}{y}                                                                               \\
        \displaystyle 0 = \rho g_z -\pdv{p}{z}
    \end{cases}
\end{equation*}
Depending on the problem, we can further simplify these equations if:
\begin{itemize}
    \item the body force acts in one direction, or if it is negligible.
    \item the flow is steady, so that all time derivatives are zero.
    \item the flow is in 2D, so that there is no variation in the
          \(z\)-direction.
    \item there is no pressure gradient driving the flow, so that
          \(\displaystyle\pdv{p}{x} = 0\).
\end{itemize}
After simplifying these equations, we can often solve this system of
PDEs through the method of separation of variables.
\subsection{Boundary Conditions}
A common boundary condition for fluid flow is the no-slip condition,
which states that the velocity of the fluid at the boundary of a solid
object is equal to the velocity of the object. This can be expressed
as:
\begin{equation*}
    u = U \quad \text{at } y = 0
\end{equation*}
where \(U\) is the velocity of the object. When the object is stationary,
this condition reduces to:
\begin{equation*}
    u = 0 \quad \text{at } y = 0.
\end{equation*}
\section{Dimensionless Form}
Consider a non-dimensional form of the Navier-Stokes equations, where
all variables are scaled by their dimensional counterparts. Here we
will introduce the following dimensionless variables:
\begin{equation*}
    \hat{\symbf{x}} = \frac{1}{\mathsf{L}} \symbf{x}, \quad \hat{t} = \frac{1}{\mathsf{T}} t, \quad \hat{\symbf{q}} = \frac{1}{\mathsf{Q}} \symbf{q}, \quad \hat{\symbf{p}} = \frac{1}{\mathsf{P}} \symbf{p},
\end{equation*}
where \(\mathsf{L}\), \(\mathsf{T}\), \(\mathsf{Q}\), and \(\mathsf{P}\)
are characteristic length, time, velocity, and pressure scales,
respectively. By substituting these into the Navier-Stokes equations,
we can find the dimensionless form of the governing equations of
incompressible fluid flow:
\begin{equation*}
    \rho \left( \frac{\mathsf{Q}}{\mathsf{T}} \pdv{\hat{\symbf{q}}}{t} + \frac{\mathsf{Q^2}}{\mathsf{L}} \left( \hat{\symbf{q}} \cdot \hat{\symbf{\nabla}} \right) \hat{\symbf{q}} \right) = \rho \symbf{g} - \frac{\mathsf{P}}{\mathsf{L}} \hat{\symbf{\nabla}} \hat{p} + \frac{\mu \mathsf{Q}}{\mathsf{L}^2} \hat{\nabla}^2 \hat{\symbf{q}}
\end{equation*}
Let us then define the velocity scale as the ratio of the characteristic
length to the characteristic time:
\begin{equation*}
    \mathsf{Q} = \frac{\mathsf{L}}{\mathsf{T}}.
\end{equation*}
This lets us factor the dimensions on the material derivative:
\begin{equation*}
    \frac{\rho \mathsf{Q}^2}{\mathsf{L}} \left( \pdv{\hat{\symbf{q}}}{t} + \left( \hat{\symbf{q}} \cdot \hat{\symbf{\nabla}} \right) \hat{\symbf{q}} \right) = \rho g \hat{\symbf{g}} - \frac{\mathsf{P}}{\mathsf{L}} \hat{\symbf{\nabla}} \hat{p} + \frac{\mu \mathsf{Q}}{\mathsf{L}^2} \hat{\nabla}^2 \hat{\symbf{q}},
\end{equation*}
where \(g\) is the magnitude of \(\symbf{g}\).
The magnitudes of the terms in the Navier-Stokes equations can be
compared by considering the order of magnitude of each term:
\begin{itemize}
    \item \textbf{Inertial Force}: \(\mathcal{O}\left( \frac{\rho \mathsf{Q}^2}{\mathsf{L}} \right)\)
          from \(
          \pdv{\hat{\symbf{q}}}/{t} + \left( \hat{\symbf{q}} \cdot \hat{\symbf{\nabla}} \right) \hat{\symbf{q}}
          \).
    \item \textbf{Gravity Force}: \(\mathcal{O}\left( \rho g \right)\)
          from \(
          \hat{\symbf{g}}
          \).
    \item \textbf{Pressure Gradient Force}: \(\mathcal{O}\left( \frac{\mathsf{P}}{\mathsf{L}} \right)\)
          from \(
          \hat{\symbf{\nabla}} \hat{p}
          \).
    \item \textbf{Viscous Force}: \(\mathcal{O}\left( \frac{\mu \mathsf{Q}}{\mathsf{L}^2} \right)\)
          from \(
          \hat{\nabla}^2 \hat{\symbf{q}}
          \).
\end{itemize}
\subsection{Reynolds and Froude Numbers}
If we consider the ratio of the inertial force to the viscous force, we
derive the \textit{Reynolds number}:
\begin{equation*}
    \mathrm{Re} = \frac{\rho \mathsf{Q} \mathsf{L}}{\mu} = \frac{\text{Inertial Force}}{\text{Viscous Force}}.
\end{equation*}
This number is a measure of the relative importance of inertial forces
to viscous forces in a fluid flow.
\begin{itemize}
    \item For \(\mathrm{Re} \ll 1\), the flow is dominated by viscous
          forces, characterised by low velocity or high viscosity. This
          regime is known as \textbf{viscous flow} or \textbf{Stokes
          flow}.
    \item For \(\mathrm{Re} \gg 1\), the flow is dominated by inertial
          forces, characterised by high velocity or low viscosity. This
          is referred to as \textbf{inviscid flow} or \textbf{ideal
          flow}.
\end{itemize}
We can also consider the ratio of the inertial force to the body force
to derive the \textit{Froude number} when considering the effects of
gravity:
\begin{equation*}
    \mathrm{Fr} = \frac{\mathsf{Q}}{\sqrt{g \mathsf{L}}} = \sqrt{\frac{\text{Inertial Force}}{\text{Gravity Force}}}.
\end{equation*}
This number is a measure of the relative importance of inertial forces
to gravitational forces in a fluid flow.
\begin{itemize}
    \item For \(\mathrm{Fr} < 1\), the flow is dominated by
          gravitational forces and disturbances propogate upstream.
          This is known as \textbf{subcritical flow}.
    \item For \(\mathrm{Fr} > 1\), the flow is dominated by inertial
          forces and disturbances propagate downstream. This is known
          as \textbf{supercritical flow}.
    \item For \(\mathrm{Fr} = 1\), the flow is in a state of
          \textbf{critical flow} where the flow velocity matches the
          wave speed.
\end{itemize}
We can express the Navier-Stokes equations in dimensionless form using
these dimensionless variables:
\begin{equation*}
    \mathrm{Re} \mdv{\hat{\symbf{q}}}{t} = \frac{\mathrm{Re}}{\mathrm{Fr}^2} \hat{\symbf{g}} - \frac{\mathsf{P} \mathsf{L}}{\mathsf{Q} \mu} \hat{\symbf{\nabla}} \hat{p} + \hat{\nabla}^2 \hat{\symbf{q}} \iff \mdv{\hat{\symbf{q}}}{t} = \frac{1}{\mathrm{Fr}^2} \hat{\symbf{g}} - \frac{\mathsf{P}}{\rho \mathsf{Q}^2} \hat{\symbf{\nabla}} \hat{p} + \frac{1}{\mathrm{Re}} \hat{\nabla}^2 \hat{\symbf{q}},
\end{equation*}
with the constitutive relationship:
\begin{equation*}
    \hat{\symbf{\nabla}} \cdot \hat{\symbf{q}} = 0,
\end{equation*}
for incompressible flow.
\section{Inviscid Flow}
If we suppose that flow is inviscid, \(\mathrm{Re} \gg 1\), and we can
simplify the Navier-Stokes by removing the viscous term:
\begin{equation*}
    \mdv{\hat{\symbf{q}}}{t} = \frac{1}{\mathrm{Fr}^2} \hat{\symbf{g}} - \frac{\mathsf{P}}{\rho \mathsf{Q}^2} \hat{\symbf{\nabla}} \hat{p}.
\end{equation*}
Notice all terms are dimensionless and suggests that the pressure scale
is proportional to the square of the velocity scale:
\begin{equation*}
    \mathsf{P} = \rho \mathsf{Q}^2.
\end{equation*}
This allows us to simplify the governing equations to\footnote{Note we have
    dropped the hats on the variables for brevity.}:
\begin{equation*}
    \mdv{\symbf{q}}{t} = \frac{1}{\mathrm{Fr}^2} \symbf{g} - \symbf{\nabla} p,
\end{equation*}
with the constitutive relationship:
\begin{equation*}
    \symbf{\nabla} \cdot \symbf{q} = 0.
\end{equation*}
This system of equations is known as the \textit{Euler equations} and
describes the flow of an inviscid fluid.
\subsection{Irrotational Flow}
Consider a flow whose vorticity (tendency to rotate) is zero. This type
of flow is known as \textit{irrotational flow} or \textit{potential
flow}, where we assume the velocity field is conservative:
\begin{equation*}
    \symbf{q} = \symbf{\nabla} \phi.
\end{equation*}
Here \(\phi = \phi\left( x,\: y,\: z,\: t \right)\) is a velocity
potential with continuous second derivatives. When flow is both
inviscid and irrotational, it is called \textit{ideal flow}. Using this
restriction, we can further simplify the Euler equations by reducing the
material derivative as follows:
\begin{align*}
    \mdv{\symbf{q}}{t} & = \pdv{\symbf{q}}{t} + \left( \symbf{q} \cdot \symbf{\nabla} \right) \symbf{q}                                                                               \\
                       & = \pdv{\symbf{q}}{t} + \frac{1}{2} \symbf{\nabla} \left( \symbf{q} \cdot \symbf{q} \right) - \symbf{q} \times \left( \symbf{\nabla} \times \symbf{q} \right) \\
                       & = \pdv{\symbf{q}}{t} + \frac{1}{2} \symbf{\nabla} \norm*{\symbf{q}}^2                                                                                        \\
                       & = \pdv{\symbf{\nabla} \phi}{t} + \frac{1}{2} \symbf{\nabla} \norm*{\symbf{\nabla} \phi}^2                                                                    \\
                       & = \symbf{\nabla} \left( \pdv{\phi}{t} + \frac{1}{2} \norm*{\symbf{\nabla} \phi}^2 \right).
\end{align*}
Then, if we assume the body forces only consist of gravitational forces
that act in the \(z\)-direction, we can express this force as:
\begin{equation*}
    \symbf{g} = -\symbf{k} = -\symbf{\nabla} \left( z \right).
\end{equation*}
So, the Euler equations for inviscid, irrotational flow are:
\begin{align*}
    \symbf{\nabla} \left( \pdv{\phi}{t} + \frac{1}{2} \norm*{\symbf{\nabla} \phi}^2 \right)                                 & = -\symbf{\nabla} p - \frac{1}{\mathrm{Fr}^2} \symbf{\nabla} \left( z \right) \\
    \symbf{\nabla} \left( \pdv{\phi}{t} + \frac{1}{2} \norm*{\symbf{\nabla} \phi}^2 \right)                                 & = -\symbf{\nabla} \left( p + \frac{1}{\mathrm{Fr}^2} z \right)                \\
    \symbf{\nabla} \left( \pdv{\phi}{t} + \frac{1}{2} \norm*{\symbf{\nabla} \phi}^2 + p + \frac{1}{\mathrm{Fr}^2} z \right) & = 0                                                                           \\
    \pdv{\phi}{t} + \frac{1}{2} \norm*{\symbf{\nabla} \phi}^2 + p + \frac{1}{\mathrm{Fr}^2} z                               & = c\left( t \right).
\end{align*}
Note that if we choose
\(\phi = \bar{\phi} + \int c\left( t \right) \odif{t}\), then:
\begin{align*}
    \pdv{\bar{\phi}}{t} + c\left( t \right) + \frac{1}{2} \norm*{\symbf{\nabla} \bar{\phi}}^2 + p + \frac{1}{\mathrm{Fr}^2} z & = c\left( t \right) \\
    \pdv{\bar{\phi}}{t} + \frac{1}{2} \norm*{\symbf{\nabla} \bar{\phi}}^2 + p + \frac{1}{\mathrm{Fr}^2} z                     & = 0.
\end{align*}
Therefore, as \(c\left( t \right)\) plays no role in this equation
we can choose \(c\left( t \right) = 0\). Therefore, for inviscid,
irrotational flow, the governing equation is given by:
\begin{equation*}
    \pdv{\phi}{t} + \frac{1}{2} \norm*{\symbf{\nabla} \phi}^2 + p + \frac{1}{\mathrm{Fr}^2} z = 0.
\end{equation*}
This result is known as \textbf{Bernoulli's equation}. Additionally,
the continuity equation becomes:
\begin{equation*}
    \symbf{\nabla} \cdot \symbf{q} = \symbf{\nabla} \cdot \symbf{\nabla} \phi = \nabla^2 \phi = 0.
\end{equation*}
This is precisely Laplace's equation, a linear second-order elliptic
PDE that can be solved using separation of variables. Thus, by solving
this equation, we can find the velocity potential \(\phi\) which satisfies
Bernoulli's equation.
\subsection{Boundary Conditions}
For inviscid, irrotational flow, we can no longer use the no-slip
condition as the flow is inviscid, so the fluid can slip past the
boundary. Instead, we enforce the condition that the normal velocity to
the boundary is zero:
\begin{equation*}
    \symbf{q} \cdot \symbf{n} = 0 \implies \symbf{\nabla} \phi \cdot \symbf{n} = 0,
\end{equation*}
for a solid boundary with normal vector \(\symbf{n}\). This ensures that
flow does not penetrate the boundary. For a solid boundary that is
moving with velocity \(\symbf{U}\), this condition
becomes:
\begin{equation*}
    \left( \symbf{q} - \symbf{U} \right) \cdot \symbf{n} = 0 \implies \symbf{\nabla} \phi \cdot \symbf{n} = \symbf{U} \cdot \symbf{n}.
\end{equation*}
\subsection{Complex Potentials}
In this section, let us consider complex functions of the form
\begin{equation*}
    f\left( z \right) = \phi\left( x,\: y \right) + i \psi\left( x,\: y \right), \quad z = x + iy.
\end{equation*}
Here, we will suppose that the real part of this function, \(\phi\), is
the velocity potential discussed earlier, and the imaginary part,
\(\psi\), is a new function which we will call a \textit{stream
    function}. A key result from complex analysis states that
an analytic (infinitely differentiable) function satisfies the
Cauchy-Riemann equations:
\begin{equation*}
    \pdv{\phi}{x} = \pdv{\psi}{y}, \quad \pdv{\phi}{y} = -\pdv{\psi}{x}.
\end{equation*}
This allows us to relate the velocity field to the stream function in
Cartesian coordinates as:
\begin{equation*}
    q_x = \pdv{\phi}{x} = \pdv{\psi}{y}, \quad q_y = \pdv{\phi}{y} = -\pdv{\psi}{x}.
\end{equation*}
If we assume both \(\phi\) and \(\psi\) are sufficiently smooth, and
take the derivatives of each expression w.r.t., \(x\) and \(y\), we find:
\begin{align*}
    \pdv*{\left( \pdv{\phi}{x} \right)}{x} = \pdv*{\left( \pdv{\psi}{y} \right)}{x}  & \implies \pdv[order=2]{\phi}{x} = \pdv{\psi}{xy},  \\
    \pdv*{\left( \pdv{\phi}{y} \right)}{y} = \pdv*{\left( -\pdv{\psi}{x} \right)}{y} & \implies \pdv[order=2]{\phi}{y} = -\pdv{\psi}{yx}.
\end{align*}
By Schwarz's theorem, we can also interchange the order of
differentiation of the mixed partial derivatives in these equations,
giving us the following equalities:
\begin{equation*}
    \pdv[order=2]{\phi}{x} = - \pdv[order=2]{\phi}{y} \implies \pdv[order=2]{\phi}{x} + \pdv[order=2]{\phi}{y} = 0 \implies \nabla^2 \phi = 0.
\end{equation*}
Using a similar argument, we can also show that \(\nabla^2 \psi = 0\).
Thus, both the velocity potential and the stream function satisfy
Laplace's equation, and furthermore, also satisfy Bernoulli's equation.
Therefore, we can refer to the complex function \(f\left( z \right)\)
as a \textit{complex potential} for the flow.

To summarise, the complex potential for inviscid, irrotational flow
encapsulates the velocity and direction of a flow. Here, the velocity
potential \(\phi\) represents the potential energy of the flow, and the
stream function \(\psi\) offers a geometric visualisation of the flow's
direction. We can plot the \textit{streamlines} of the flow, that is,
the paths that fluid particles follow, by plotting the level curves of
\(\psi\) where \(\psi\) is constant.
\subsubsection{Uniform Streams}
The simplest example of a complex potential arises from a steady
uniform stream in the \(x\)-direction with constant velocity \(U\). The
velocity for this flow is given by:
\begin{equation*}
    u = U, \quad v = 0.
\end{equation*}
Using the above relationships between the velocity field, velocity
potential, and stream function, we can construct the following complex
potential function for this flow:
\begin{equation*}
    f\left( z \right) = Uz = Ux + i Uy \implies \phi = Ux, \quad \psi = Uy.
\end{equation*}
\subsubsection{Dipoles}
If this flow is obstructed by a solid disk with radius \(a\), we can
solve for this complex potential using polar coordinates. Due to the
additional complexity of this boundary condition, we will need to first
find the velocity potential \(\phi\) to find the velocity field and
stream function. We can do this by solving Laplace's equation for the
velocity potential with a solid boundary condition, assuming that in
the far-field, the flow is uniform.
\begin{gather*}
    \nabla^2 \phi = 0, \\
    \nabla \phi \cdot \symbf{n} = 0 \text{ on } r = a, \\
    \quad \phi \sim U r \cos{\left( \theta \right)} \text{ as } r \to \infty.
\end{gather*}
We will use separation of variables to solve this problem, by assuming
that \(\phi\left( r,\: \theta \right) = R\left( r \right) \cos{\left( \theta \right)}\).
\begin{align*}
    \frac{1}{r} \pdv*{\left( r \pdv{\phi}{r} \right)}{r} + \frac{1}{r^2} \pdv[order=2]{\phi}{\theta}                    & = 0, \\
    r \pdv*{\left( r R' \cos{\left( \theta \right)} \right)}{r} - R \cos{\left( \theta \right)}                         & = 0, \\
    r \left( R' \cos{\left( \theta \right)} + r R'' \cos{\left( \theta \right)} \right) - R \cos{\left( \theta \right)} & = 0, \\
    \left( r^2 R'' + r R' - R \right) \cos{\left( \theta \right)}                                                       & = 0.
\end{align*}
This is an Euler-Cauchy equation, which can be solved by assuming a
solution of the form \(R\left( r \right) = r^n\):
\begin{align*}
    n \left( n - 1 \right) r^n + n r^n - r^n & = 0,     \\
    n^2 - 1                                  & = 0      \\
    n                                        & = \pm 1.
\end{align*}
Therefore, the general solution to this equation is:
\begin{equation*}
    \phi\left( r,\: \theta \right) = A r \cos{\left( \theta \right)} + B r^{-1} \cos{\left( \theta \right)}.
\end{equation*}
If we apply the first boundary condition, we find,
\begin{align*}
    \nabla \phi \cdot \symbf{n}                                                                                                   & = 0         \\
    \left( \pdv{\phi}{r} \symbf{e}_r + \frac{1}{r} \pdv{\phi}{\theta} \symbf{e}_{\theta} \right) \cdot \left( \symbf{e}_r \right) & = 0         \\
    \pdv{\phi}{r}                                                                                                                 & = 0         \\
    A \cos{\left( \theta \right)} - B r^{-2} \cos{\left( \theta \right)}                                                          & = 0         \\
    A - B a^{-2}                                                                                                                  & = 0         \\
    A                                                                                                                             & = B a^{-2},
\end{align*}
so that,
\begin{equation*}
    \phi\left( r,\: \theta \right) = B a^{-2} r \cos{\left( \theta \right)} + B r^{-1} \cos{\left( \theta \right)}.
\end{equation*}
The far-field condition implies that the following limit must hold:
\begin{align*}
    \lim_{r \to \infty} \frac{\phi}{U r \cos{\left( \theta \right)}}                                                                          & = 1      \\
    \lim_{r \to \infty} \frac{B a^{-2} r \cos{\left( \theta \right)} + B r^{-1} \cos{\left( \theta \right)}}{U r \cos{\left( \theta \right)}} & = 1      \\
    \lim_{r \to \infty} \frac{B a^{-2} \cos{\left( \theta \right)} + B r^{-2} \cos{\left( \theta \right)}}{U \cos{\left( \theta \right)}}     & = 1      \\
    \frac{B a^{-2} \cos{\left( \theta \right)}}{U \cos{\left( \theta \right)}}                                                                & = 1      \\
    B                                                                                                                                         & = U a^2.
\end{align*}
Therefore, the velocity potential for this flow is given by:
\begin{equation*}
    \phi\left( r,\: \theta \right) = U r \cos{\left( \theta \right)} + U a^2 r^{-1} \cos{\left( \theta \right)}.
\end{equation*}
This solution has a dividing streamline on \(x = 0\), where the flow
above the \(x\)-axis is directed upwards above the disk, and the flow
below the \(x\)-axis is directed downwards below the disk. The
streamline at \(\psi = 0\), intersects the disk at two points
\(\left( 0,\: \pm a \right)\) known as \textit{stagnation points}, where
the velocity is zero.
Given that Laplace's equation is linear, we can separate this solution
into the velocity potentials for a uniform stream and a \textit{dipole}.
This dipole has the following velocity potential:
\begin{equation*}
    \phi = U a^2 r^{-1} \cos{\left( \theta \right)}.
\end{equation*}
This solution describes a circular flow that grows outwards from the
left of the origin, and enters the origin from the right. The velocity
of this flow is given by:
\begin{align*}
    q_r        & = \pdv{\phi}{r} = -U a^2 r^{-2} \cos{\left( \theta \right)},                  \\
    q_{\theta} & = \frac{1}{r} \pdv{\phi}{\theta} = -U a^2 r^{-2} \sin{\left( \theta \right)}.
\end{align*}
The stream function for this flow is given by:
\begin{equation*}
    \psi = -U a^2 r^{-1} \sin{\left( \theta \right)}.
\end{equation*}
Note that as the magnitude of the velocity field approaches infinity as
\(r \to 0\), there is a singularity at the origin. The complex potential
for this flow is given by:
\begin{align*}
    f\left( z \right) & = \frac{U a^2}{r} \cos{\left( \theta \right)} - i \frac{U a^2}{r} \sin{\left( \theta \right)}    \\
                      & = \frac{U a^2}{r} \left( \cos{\left( \theta \right)} - i \sin{\left( \theta \right)} \right)     \\
                      & = \frac{U a^2}{r^2} r \left( \cos{\left( \theta \right)} - i \sin{\left( \theta \right)} \right) \\
                      & = \frac{U a^2}{z \bar{z}} \bar{z}                                                                \\
                      & = \frac{U a^2}{z}.
\end{align*}
\subsubsection{Vortices}
The flow described above does not generate any lift on the solid disk,
as there is no circulation in the flow. This can also be deduced by the
fact that the streamlines are symmetric about the \(x\)-axis. If we
were to consider a solution to Laplace's equation that depends on the
angular coordinate, \(\phi = \phi\left( \theta \right)\), we can
construct a potential that generates a vortex. One such solution is
given by:
\begin{equation*}
    \phi = \frac{\Gamma}{2\pi} \theta
\end{equation*}
where we will claim that \(\Gamma\) is the circulation of the flow. The
velocity field and stream function for this potential are given by:
\begin{equation*}
    q_r = 0, \quad q_{\theta} = \frac{\Gamma}{2\pi r}, \quad \psi = -\frac{\Gamma}{2\pi} \ln{\left( r \right)}.
\end{equation*}
When combined with the potential from the previous section, this flow
generates a lift on the circular object, with a stagnation point at the
top of the disk (when \(\Gamma > 0\)). If we compute the circulation of
this flow around the circle, we find that \(\Gamma\) is indeed the
circulation of the flow:
\begin{align*}
    \oint_{\mathscr{C}} \symbf{q} \cdot \odif{\symbf{r}} & = \int_{0}^{2\pi} \left( \frac{\Gamma}{2\pi r} \symbf{e}_{\theta} \right) \cdot \left( \symbf{e}_{\theta} - \symbf{e}_r \right) r \odif{\theta} \\
                                                         & = \int_{0}^{2\pi} \frac{\Gamma}{2\pi} \odif{\theta}                                                                                             \\
                                                         & = \Gamma.
\end{align*}
The complex potential for this flow is given by:
\begin{align*}
    f\left( z \right) & = \frac{\Gamma}{2\pi} \theta - i \frac{\Gamma}{2\pi} \ln{\left( r \right)}         \\
                      & = \frac{\Gamma}{2\pi} \left( \theta - i \ln{\left( r \right)} \right)              \\
                      & = -i \frac{\Gamma}{2\pi} \left( \ln{\left( r \right)} - \frac{1}{i} \theta \right) \\
                      & = \frac{\Gamma}{2\pi i} \left( \ln{\left( r \right)} + i \theta \right)            \\
                      & = \frac{\Gamma}{2\pi i} \Log{\left( z \right)},
\end{align*}
where \(\Log\) is the principal branch of the complex logarithm.
\subsubsection{Line Sources and Sinks}
Consider a 2D source at the origin that emits fluid radially outwards
through a circle a constant rate. Here we will assume that the
potential function is only dependent on the radial coordinate, \(\phi =
\phi\left( r \right)\). Upon solving Laplace's equation for this
potential, we can construct a solution of the form:
\begin{equation*}
    \phi = \frac{\Phi}{2\pi} \ln{\left( r \right)},
\end{equation*}
where we will claim that \(\Phi\) is the strength of the source. The
velocity field and stream function for this potential are given by:
\begin{equation*}
    q_r = \frac{\Phi}{2\pi r}, \quad q_{\theta} = 0, \quad \psi = \frac{\Phi}{2\pi} \theta.
\end{equation*}
This flow is generated by a source at the origin, where the fluid has a
greater velocity near the source. If we compute the flux of this flow
across a circle of radius \(r\), we find that the flux is precisely
equal to the strength of the source:
\begin{align*}
    \iint_{\mathscr{S}} \symbf{q} \cdot \odif{\symbf{\sigma}} & = \iint_{\mathscr{S}} \symbf{q} \cdot \symbf{n} \odif{\sigma}                                                     \\
                                                              & = \int_0^{2\pi} \left( \frac{\Phi}{2\pi r} \symbf{e}_{r} \right) \cdot \left( r \symbf{e}_r \right) \odif{\theta} \\
                                                              & = \int_0^{2\pi} \frac{\Phi}{2\pi} \odif{\theta}                                                                   \\
                                                              & = \Phi.
\end{align*}
The complex potential for this flow is given by:
\begin{align*}
    f\left( z \right) & = \frac{\Phi}{2\pi} \ln{\left( r \right)} + i \frac{\Phi}{2\pi} \theta \\
                      & = \frac{\Phi}{2\pi} \left( \ln{\left( r \right)} + i \theta \right)    \\
                      & = \frac{\Phi}{2\pi} \Log{\left( z \right)}.
\end{align*}
When the source is replaced by a sink, the potential function becomes:
\begin{equation*}
    \phi = -\frac{\Phi}{2\pi} \ln{\left( r \right)},
\end{equation*}
where the velocity field and stream function are given by:
\begin{equation*}
    q_r = -\frac{\Phi}{2\pi r}, \quad q_{\theta} = 0, \quad \psi = -\frac{\Phi}{2\pi} \theta.
\end{equation*}
The complex potential for this flow is given by:
\begin{equation*}
    f\left( z \right) = -\frac{\Phi}{2\pi} \Log{\left( z \right)}.
\end{equation*}
\subsubsection{Point Sources and Sinks}
We can extend the above solutions to the case of a 3D source at the
origin that emits fluid radially outwards through a sphere at a
constant rate. We will make the same assumptions as before, but instead
use spherical coordinates to solve Laplace's equation. The potential
function for this flow is given by:
\begin{equation*}
    \phi = \frac{\Phi}{4\pi r},
\end{equation*}
where we will claim that \(\Phi\) is the strength of the source. The
velocity field for this potential is given by:
\begin{equation*}
    q_r = \frac{\Phi}{4\pi r^2}, \quad q_{\theta} = 0, \quad q_{\phi} = 0.
\end{equation*}
Note that it is not possible to construct a stream function and
therefore also a complex potential for this flow as there are more
than two degrees of freedom in the flow. The flux of this flow across a
sphere of radius \(r\) is given by:
\begin{align*}
    \iint_{\mathscr{S}} \symbf{q} \cdot \odif{\symbf{\sigma}} & = \iint_{\mathscr{S}} \symbf{q} \cdot \symbf{n} \odif{\sigma}                                                                                                                \\
                                                              & = \int_0^{2\pi} \int_0^{\pi} \left( \frac{\Phi}{4\pi r^2} \symbf{e}_{r} \right) \cdot \left( \symbf{e}_{r} \right) r^2 \sin{\left( \theta \right)} \odif{\theta} \odif{\phi} \\
                                                              & = \int_0^{2\pi} \int_0^{\pi} \frac{\Phi}{4\pi} \sin{\left( \theta \right)} \odif{\theta} \odif{\phi}                                                                         \\
                                                              & = \Phi.
\end{align*}
When the source is replaced by a sink, the potential function becomes:
\begin{equation*}
    \phi = -\frac{\Phi}{4\pi r},
\end{equation*}
where the velocity field for this potential is given by:
\begin{equation*}
    q_r = -\frac{\Phi}{4\pi r^2}, \quad q_{\theta} = 0, \quad q_{\phi} = 0.
\end{equation*}
\subsubsection{Flow Around a Corner}
Another interesting flow arises from the complex polynomial
\begin{align*}
    f\left( z \right) & = z^2                      \\
                      & = \left( x + i y \right)^2 \\
                      & = x^2 + 2 i x y - y^2      \\
                      & = x^2 - y^2 + 2 i x y,
\end{align*}
where the velocity potential and stream function are given by:
\begin{equation*}
    \phi = x^2 - y^2, \quad \psi = 2xy.
\end{equation*}
This flow rotates fluid particles in a clockwise direction around the
origin, from the positive \(x\)-axis. By varying the power of the
polynomial \(\alpha\), we can describe flows around corners of different
angles. When \(n = 1/2\), we have flow around a wall that extends right
from the origin, and for \(1/2 < n < 1\), we have flow around the
exterior of corners of angles \(\pi/n\). When \(n = 1\), we recover the
flow of a uniform stream, and when \(n > 1\), we have flow around the
interior of corners of angles \(\pi/n\).
\section{Viscous Flow}
If a flow is dominated by viscous forces, or moves at low velocities,
we can assume that the Reynolds number is small, \(\mathrm{Re} \ll 1\).
In this regime, the dimensionless Navier-Stokes equations can be
simplified to:
\begin{equation*}
    \symbf{0} = -\symbf{\nabla} p + \nabla^2 \symbf{q},
\end{equation*}
where we scale the pressure by the viscous stress scale,
\begin{equation*}
    \mathsf{P} = \frac{\mu \mathsf{Q}}{\mathsf{L}}.
\end{equation*}
This equation is known as the \textit{Stokes equation}, and the flow
described by this equation is known as \textit{Stokes flow} or
\textit{creeping flow}. This equation is linear and can be solved for
analytically for simple geometries. Additionally, as the PDE does not
depend on time, the state of the flow can be determined without
knowledge of the flow at any other time---this is known as instantaneity.
An immediate consequence of instantaneity is time-reversibility, which
means that a flow that is time-reversed is also a solution to the
Stokes equation. This property means that it is difficult to mix two
fluids in Stokes flow, as the flow can be reversed to separate the
fluids.
\subsection{}
We can eliminate the pressure term in the Stokes equation by using the
identity:
\begin{equation*}
    \nabla^2 \symbf{q} = \symbf{\nabla} \left( \symbf{\nabla} \cdot \symbf{q} \right) - \symbf{\nabla} \times \left( \symbf{\nabla} \times \symbf{q} \right).
\end{equation*}
This allows us to rewrite the Stokes equation as:
\begin{align*}
    \symbf{0} & = -\symbf{\nabla} p + \nabla^2 \symbf{q}                                                                                                                                 \\
    \symbf{0} & = -\symbf{\nabla} p + \left( \symbf{\nabla} \left( \symbf{\nabla} \cdot \symbf{q} \right) - \symbf{\nabla} \times \left( \symbf{\nabla} \times \symbf{q} \right) \right) \\
    \symbf{0} & = -\symbf{\nabla} p - \symbf{\nabla} \times \left( \symbf{\nabla} \times \symbf{q} \right).
\end{align*}
If we then take the curl of this equation, we find:
\begin{align*}
    \symbf{\nabla} \times \symbf{0} & = \symbf{\nabla} \times \left( \symbf{\nabla} p \right) + \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \symbf{\nabla} \times \symbf{q} \right) \right) \\
    \symbf{0}                       & = \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \symbf{\nabla} \times \symbf{q} \right) \right).
\end{align*}
Therefore, the governing equation for Stokes flow is given by:
\begin{equation*}
    \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \symbf{\nabla} \times \symbf{q} \right) \right) = \symbf{0},
\end{equation*}
with the constitutive relationship:
\begin{equation*}
    \symbf{\nabla} \cdot \symbf{q} = 0.
\end{equation*}
\subsection{Solutions using Stream Functions}
In 2D, the continuity equation is identically satisfied by the stream
function defined by the Cauchy-Riemann equations. If we express the
velocity field in terms of the stream function, we find:
\begin{align*}
    \symbf{q} & =
    \begin{bmatrix}
        \displaystyle \pdv{\psi}{y}  \\[2ex]
        \displaystyle -\pdv{\psi}{x} \\[2ex]
        0
    \end{bmatrix}
    \\
              & =
    \begin{vmatrix}
        \symbf{i}              & \symbf{j}              & \symbf{k}              \\
        \displaystyle \pdif{x} & \displaystyle \pdif{y} & \displaystyle \pdif{z} \\
        0                      & 0                      & \psi
    \end{vmatrix}
    \\
              & = \symbf{\nabla} \times \left( \psi \symbf{k} \right).
\end{align*}
The governing equation then becomes:
\begingroup
\allowdisplaybreaks
\begin{align*}
    \symbf{0} & = \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \symbf{\nabla} \times \symbf{q} \right) \right)                                                          \\
    \symbf{0} & = \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \psi \symbf{k} \right) \right) \right) \right) \\
    \symbf{0} & = \symbf{\nabla} \times \left( \symbf{\nabla} \times
    \begin{vmatrix}
        \symbf{i}                   & \symbf{j}                    & \symbf{k}              \\
        \displaystyle \pdif{x}      & \displaystyle \pdif{y}       & \displaystyle \pdif{z} \\
        \displaystyle \pdv{\psi}{y} & \displaystyle -\pdv{\psi}{x} & 0
    \end{vmatrix}
    \right)                                                                                                                                                                          \\
    \symbf{0} & = \symbf{\nabla} \times \left( \symbf{\nabla} \times
    \left( \pdv{\psi}{z,x} \symbf{i} + \pdv{\psi}{z,y} \symbf{j} + \left( - \pdv[order=2]{\psi}{x} - \pdv[order=2]{\psi}{y} \right) \symbf{k} \right)
    \right)                                                                                                                                                                          \\
    \symbf{0} & = - \symbf{\nabla} \times \left( \symbf{\nabla} \times \left( \nabla^2 \psi \symbf{k} \right) \right)                                                                \\
    \symbf{0} & = - \symbf{\nabla} \times
    \begin{vmatrix}
        \symbf{i}              & \symbf{j}              & \symbf{k}              \\
        \displaystyle \pdif{x} & \displaystyle \pdif{y} & \displaystyle \pdif{z} \\
        0                      & 0                      & \nabla^2 \psi
    \end{vmatrix}
    \\
    \symbf{0} & = - \symbf{\nabla} \times
    \left( \pdv{\nabla^2 \psi}{y} \symbf{i} - \pdv{\nabla^2 \psi}{y} \symbf{j} \right)
    \\
    \symbf{0} & = -
    \begin{vmatrix}
        \symbf{i}              & \symbf{j}              & \symbf{k}              \\
        \displaystyle \pdif{x} & \displaystyle \pdif{y} & \displaystyle \pdif{z} \\
        \displaystyle \pdv{\nabla^2 \psi}{y} & \displaystyle -\pdv{\nabla^2 \psi}{x} & 0
    \end{vmatrix}
    \\
    \symbf{0} & = - \left( \pdv{\nabla^2 \psi}{z,x} \symbf{i} + \pdv{\nabla^2 \psi}{z,y} \symbf{j} + \left( - \pdv[order=2]{\nabla^2 \psi}{x} - \pdv[order=2]{\nabla^2 \psi}{y} \right) \symbf{k} \right) \\
    \symbf{0} & = \left( \pdv[order=2]{\nabla^2 \psi}{x} + \pdv[order=2]{\nabla^2 \psi}{y} \right) \symbf{k} \\
    \symbf{0} & = \nabla^2 \left( \nabla^2 \psi \right) \symbf{k} \\
    \symbf{0} & = \nabla^4 \psi \symbf{k}.
\end{align*}
\endgroup
Therefore, in 2D, the governing equation for Stokes flow is a single
fourth-order PDE,
\begin{equation*}
    \nabla^4 \psi = 0.
\end{equation*}
This equation is known as the \textit{biharmonic equation}, and can be
solved using separation of variables, often by solving the second-order
Laplace's equation twice.
\subsection{Boundary Conditions}
As with unidirectional flow, we can enforce the no-slip condition along
solid boundaries for Stokes flow.
\end{document}
